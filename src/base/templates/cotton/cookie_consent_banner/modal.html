{% load i18n %}
{% load cooco %}

<dialog id="cookies_settings_modal"
        class="modal modal-bottom sm:modal-middle">
    <div class="modal-box w-11/12 max-w-5xl mx-auto bg-linear-to-br from-base-100 to-base-200 shadow-2xl p-0 flex flex-col max-h-[90vh] overflow-hidden">
        <!-- Close button -->
        <form method="dialog" class="absolute right-4 top-4 z-10">
            <c-cookie-consent-banner.buttons.close-button />
        </form>

        <!-- Header section - fixed at top -->
        <div class="bg-linear-to-r from-primary/10 to-transparent p-4 sm:p-6 border-b-2 border-primary/20 backdrop-blur-sm bg-base-100/95 shrink-0">
            <h3 class="text-2xl sm:text-3xl font-bold bg-linear-to-r from-primary to-primary/60 bg-clip-text text-transparent pr-8">
                {% translate "Cookie Settings" %}
            </h3>
        </div>

        <!-- Scrollable content area -->
        <div class="overflow-y-auto flex-1">
            <form class="p-4 sm:p-6"
                  action="{% url 'set_cookie_preferences' %}"
                  method="post">
                {% csrf_token %}
                <input name="next" type="hidden" value="{{ request.path }}" />

                <div class="grid grid-cols-1 gap-4">
                    {% get_cookie_groups as cookie_groups %}
                    {% for cookie_group in cookie_groups %}
                        <div class="card border-2 border-base-300 hover:border-primary/30 transition-colors bg-linear-to-r from-base-200 to-base-100 shadow-md">
                            <div class="card-body">
                                <h2 class="card-title text-primary font-bold">
                                    {{ cookie_group.name }}
                                </h2>
                                <div class="text-left text-base-content/80">
                                    {{ cookie_group.description }}
                                </div>
                                <div class="flex justify-end">
                                    <input name="{{ cookie_group.cookie_id }}"
                                           type="checkbox"
                                           class="toggle toggle-success"
                                           checked="checked"
                                           {% if cookie_group.is_required %}disabled{% endif %} />
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <!-- Footer - fixed at bottom -->
                <div class="modal-action mt-6">
                    <button class="btn btn-primary gap-2 group" type="submit">
                        <svg xmlns="http://www.w3.org/2000/svg"
                             class="h-5 w-5"
                             fill="none"
                             viewBox="0 0 24 24"
                             stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        <span>{% translate "Save" %}</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</dialog>
